<!doctype html>
<html lang="en">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css" integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS"
        crossorigin="anonymous">

    <script src="https://cdn.jsdelivr.net/npm/vue@2.6.4/dist/vue.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios@0.18.0/index.min.js"></script>

    <title>Arthas Tutorials</title>

    <style>
        #bd-courses{
            padding-left: 25px;
        }
        /* This is all that's required */
        .dropdown-item-checked::before {
        position: absolute;
        left: .4rem;
        content: '✓';
        font-weight: 600;
        }
    </style>
</head>

<body>
    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js" integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut"
        crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js" integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k"
        crossorigin="anonymous"></script>

    <script src="https://katacoda.com/embed.js"></script>

    <div id="app">

        <nav class="navbar navbar-expand navbar-light bg-light flex-column flex-md-row bd-navbar">
            <a href="https://github.com/alibaba/arthas" target="_blank" title="" class="navbar-brand">
                <img v-bind:src="logoUrl()" alt="Arthas" title="Welcome to Arthas web console" style="height: 25px;"
                    class="img-responsive">
            </a>

            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
                aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav mr-auto">
                    <li class="nav-item">
                        <a class="nav-link" v-bind:href="docUrl()" target="_blank">Documentation
                            <span class="sr-only">(current)</span></a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="https://github.com/alibaba/arthas" target="_blank">Github</a>
                    </li>
                    <li class="nav-item dropdown active show">
                        <!-- <button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenu2" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            Dropdown
                          </button> -->
                        <a class="nav-item nav-link dropdown-toggle mr-md-2" href="#" id="bd-tutorials" data-toggle="dropdown"
                            aria-haspopup="true" aria-expanded="true">
                            {{currentTutorialName()}}
                        </a>
                        <div class="dropdown-menu" aria-labelledby="bd-tutorials">
                            <a v-for="tutorial in tutorials" v-bind:class="{ 'dropdown-item-checked': tutorial.id === tutorialId }"
                                class="dropdown-item" v-bind:href='currentUrl() + "?language=" + language + "&id=" + tutorial.id'>
                                {{ tutorial.names[language] }}
                            </a>
                            <a v-for="scenario in scenarios" v-bind:class="{ 'dropdown-item-checked': (scenario.course +' '+ scenario.id) === tutorialId }"
                                class="dropdown-item" v-bind:href='currentUrl() + "?language=" + language + "&id=" +scenario.course +"+"+ scenario.id'>
                                {{ scenario.names[language] }}
                            </a>
                            <a v-for="category in categories" v-bind:class="{ 'dropdown-item-checked': category.id === currentCategory() }"
                            class="nav-item nav-link dropdown-toggle mr-md-2 dropdown-item" href="#" id="bd-courses" data-toggle="dropdown"
                            aria-haspopup="true" aria-expanded="true" v-on:click="{ categoryId = category.id }">
                                {{  category.names[language]  }}
                            </a>
                            <div class="dropdown-menu" aria-labelledby="bd-tutorials">
                                <a v-for="scenario in categories[findCategory()].scenarios" v-bind:class="{ 'dropdown-item-checked': (scenario.course +' '+ scenario.id) === tutorialId }"
                                    class="dropdown-item" v-bind:href='currentUrl() + "?language=" + language + "&id=" +scenario.course +"+"+ scenario.id'>
                                    {{ scenario.names[language] }}
                                </a>
                            </div>
                        </div>
                    </li>
                </ul>
            </div>

            <form class="form-inline my-2 my-lg-0">

                <div class="col">
                    <div class="input-group ">
                        <div class="input-group-prepend">
                            <span class="input-group-text" id="language-addon">Language</span>
                        </div>
                        <select class="form-control" v-model="language" class="custom-select" v-on:change="languageChange($event)">
                            <option v-for="l in languages" v-bind:value="l.value">
                                {{ l.text }}
                            </option>
                        </select>
                    </div>
            </form>

        </nav>


        <div id="kata-container" class="container-fluid px-0">

            <div id="katacoda-scenario-1" v-bind:data-katacoda-id="currentKatacodaId()" data-katacoda-color="004d7f"
                v-bind:style="{height: (calculateKataSize().height - 5) + 'px'  }">
            </div>
        </div>

    </div>
</body>


<script>
    /** get params in url **/
    function getUrlParam(name, url) {
        if (!url) url = window.location.href;
        name = name.replace(/[\[\]]/g, '\\$&');
        var regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)'),
            results = regex.exec(url);
        if (!results) return null;
        if (!results[2]) return '';
        return decodeURIComponent(results[2].replace(/\+/g, ' '));
    }

    var app = new Vue({
        el: '#app',
        data: {
            message: 'Hello Vue!',
            language: 'en',
            languages: [
                { text: 'English', value: 'en' },
                { text: '中文', value: 'cn' }
            ],
            tutorialId: "arthas-basics",
            categoryId: null,
            tutorials: [
                {
                    id: "arthas-basics",
                    names: {
                        en: "Arthas Basics",
                        cn: "Arthas基础教程",
                    },
                    ids: {
                        en: "arthas-basics-en",
                        cn: "arthas-basics-cn",
                    }
                },
                {
                    id: "arthas-advanced",
                    names: {
                        en: "Arthas Advanced",
                        cn: "Arthas进阶教程",
                    },
                    ids: {
                        en: "arthas-advanced-en",
                        cn: "arthas-advanced-cn",
                    }
                }
            ],
            categories: [
                {
                    id: "jvm",
                    names: {
                        en: "JVM related",
                        cn: "JVM相关",
                    },
                    scenarios: [
                        {
                            id:"dashboardcmd",
                            names: {
                                en: "dashboard",
                                cn: "dashboard",
                            },
                            course: "arthas"
                        },
                        {
                            id:"thread",
                            names: {
                                en: "thread",
                                cn: "thread",
                            },
                            course: "arthas"
                        },
                        {
                            id:"jvm",
                            names: {
                                en: "jvm",
                                cn: "jvm",
                            },
                            course: "arthas"
                        },
                        {
                            id:"sysprop",
                            names: {
                                en: "sysprop",
                                cn: "sysprop",
                            },
                            course: "arthas"
                        },
                        {
                            id:"sysenv",
                            names: {
                                en: "sysenv",
                                cn: "sysenv",
                            },
                            course: "arthas"
                        },
                        {
                            id:"vmoption",
                            names: {
                                en: "vmoption",
                                cn: "vmoption",
                            },
                            course: "arthas"
                        },
                        {
                            id:"perfcounter",
                            names: {
                                en: "perfcounter",
                                cn: "perfcounter",
                            },
                            course: "arthas"
                        },
                        {
                            id:"logger",
                            names: {
                                en: "logger",
                                cn: "logger",
                            },
                            course: "arthas"
                        },
                        {
                            id:"getstatic",
                            names: {
                                en: "getstatic",
                                cn: "getstatic",
                            },
                            course: "arthas"
                        },
                        {
                            id:"ognl",
                            names: {
                                en: "ognl",
                                cn: "ognl",
                            },
                            course: "arthas"
                        },
                        {
                            id:"mbean",
                            names: {
                                en: "mbean",
                                cn: "mbean",
                            },
                            course: "arthas"
                        },
                        {
                            id:"heapdump",
                            names: {
                                en: "heapdump",
                                cn: "heapdump",
                            },
                            course: "arthas"
                        }
                    ]
                },
                {
                    id: "clcll",
                    names: {
                        en: "class/classloader - related",
                        cn: "class/classloader相关",
                    },
                    scenarios: [
                        {
                            id:"sc",
                            names: {
                                en: "sc",
                                cn: "sc",
                            },
                            course: "arthas"
                        },
                        {
                            id:"sm",
                            names: {
                                en: "sm",
                                cn: "sm",
                            },
                            course: "arthas"
                        },
                        {
                            id:"jad",
                            names: {
                                en: "jad",
                                cn: "jad",
                            },
                            course: "arthas"
                        },
                        {
                            id:"mc",
                            names: {
                                en: "mc",
                                cn: "mc",
                            },
                            course: "arthas"
                        },
                        {
                            id:"redefine",
                            names: {
                                en: "redefine",
                                cn: "redefine",
                            },
                            course: "arthas"
                        },
                        {
                            id:"dump",
                            names: {
                                en: "dump",
                                cn: "dump",
                            },
                            course: "arthas"
                        },
                        {
                            id:"classloader",
                            names: {
                                en: "classloader",
                                cn: "classloader",
                            },
                            course: "arthas"
                        }
                    ]
                },
                {
                    id: "mwtrl",
                    names: {
                        en: "monitor/watch/trace - related",
                        cn: "monitor/watch/trace相关",
                    },
                    scenarios: [
                        {
                            id:"monitor",
                            names: {
                                en: "monitor",
                                cn: "monitor",
                            },
                            course: "arthas"
                        },
                        {
                            id:"watch",
                            names: {
                                en: "watch",
                                cn: "watch",
                            },
                            course: "arthas"
                        },
                        {
                            id:"trace",
                            names: {
                                en: "trace",
                                cn: "trace",
                            },
                            course: "arthas"
                        },
                        {
                            id:"stack",
                            names: {
                                en: "stack",
                                cn: "stack",
                            },
                            course: "arthas"
                        },
                        {
                            id:"tt",
                            names: {
                                en: "tt",
                                cn: "tt",
                            },
                            course: "arthas"
                        }
                    ]
                },
                {
                    id: "others",
                    names: {
                        en: "Other Commands",
                        cn: "其他命令",
                    },
                    scenarios: [
                        {
                            id: "profiler",
                            names: {
                                en: "profiler/flame graph",
                                cn: "profiler/火焰图",
                            },
                            course: "arthas"
                        },
                        {
                            id: "options",
                            names: {
                                en: "options",
                                cn: "options",
                            },
                            course: "arthas"
                        },
                        {
                            id: "pipe",
                            names: {
                                en: "pipe",
                                cn: "管道",
                            },
                            course: "arthas"
                        },
                        {
                            id: "async",
                            names: {
                                en: "async in background",
                                cn: "后台异步任务",
                            },
                            course: "arthas"
                        }
                    ]
                }
            ],
            scenarios: [
                {
                    id: "cases",
                    names: {
                        en: "Use Cases",
                        cn: "案例",
                    },
                    course: "arthas"
                },
                {
                    id: "basic-cmd",
                    names: {
                        en: "Basic Cmd & Skills",
                        cn: "基础命令和知识",
                    },
                    course: "arthas"
                }
            ],
            courses: [
                {
                    id: "arthas",
                    ids: {
                        en: "arthas-en",
                        cn: "arthas-cn",
                    }
                }
            ]
        },
        methods: {
            languageChange: function (event) {
                // alert(event.target.value)
                window.location = this.currentUrl() + "?language=" + this.language + "&id=" + this.tutorialId;
            },
            currentUrl: function () {
                return window.location.href.split(/[?#]/)[0];
            },
            logoUrl: function () {
                var url = this.currentUrl();
                return url.substring(0, url.lastIndexOf('/')) + "/_static/logo.png";
            },
            findCategory:function () {
                if (this.categoryId===null){
                    for(index in this.categories){
                        return index;
                    }
                }
                else{
                    for(index in this.categories){
                        if(this.categoryId === this.categories[index].id)
                            return index;
                    }
                }
            },
            docUrl: function () {
                if (this.language === "en") {
                    return "https://alibaba.github.io/arthas/en";
                } else {
                    return "https://alibaba.github.io/arthas";
                }
            },
            currentTutorialName: function () {
                for (index in this.tutorials) {
                    if (this.tutorials[index].id == this.tutorialId) {
                        return this.tutorials[index].names[this.language];
                    }
                }
                for (index in this.scenarios) {
                    if ((this.scenarios[index].course+" "+this.scenarios[index].id) == this.tutorialId) {
                        return this.scenarios[index].names[this.language];
                    }
                }
                for (index in this.categories) {
                    for (index2 in this.categories[index].scenarios) {
                        if (this.categories[index].scenarios[index2].course+" "+this.categories[index].scenarios[index2].id == this.tutorialId){
                            return this.categories[index].scenarios[index2].names[this.language];
                        }
                    }
                }
            },
            currentCategory: function () {
                for (index in this.categories) {
                    for (index2 in this.categories[index].scenarios) {
                        if (this.categories[index].scenarios[index2].course+" "+this.categories[index].scenarios[index2].id == this.tutorialId){
                            return this.categories[index].id;
                        }
                    }
                }
            },
            currentKatacodaId: function () {
                // https://katacoda.com/embed/arthas/arthas-advanced-cn/?embed=true
                for (index in this.tutorials) {
                    if (this.tutorials[index].id == this.tutorialId) {
                        return "arthas/" + this.tutorials[index].ids[this.language];
                    }
                }
                // https://www.katacoda.com/embed/arthas/courses/arthas-cn/cases/?embed=true
                for (index in this.scenarios) {
                    if ((this.scenarios[index].course+" "+this.scenarios[index].id) == this.tutorialId) {
                        for(index2 in this.courses){
                            if(this.courses[index2].id==this.scenarios[index].course){
                                return "arthas/courses/" + this.courses[index2].ids[this.language]+"/"+this.scenarios[index].id;
                            }
                        }
                    }
                }
                for (index in this.categories) {
                    for (index2 in this.categories[index].scenarios) {
                        if ((this.categories[index].scenarios[index2].course+" "+this.categories[index].scenarios[index2].id) == this.tutorialId) {
                            for(index3 in this.courses){
                                if(this.courses[index3].id==this.categories[index].scenarios[index2].course){
                                    return "arthas/courses/" + this.courses[index3].ids[this.language]+"/"+this.categories[index].scenarios[index2].id;
                                }
                            }
                        }
                    }
                }
            },
            calculateKataSize: function () {
                var e = window;
                var a = 'inner';
                if (!('innerWidth' in window)) {
                    a = 'client';
                    e = document.documentElement || document.body;
                }
                var terminalDiv = document.getElementById("kata-container");
                var terminalDivRect = terminalDiv.getBoundingClientRect();
                return {
                    width: terminalDivRect.width,
                    height: e[a + 'Height'] - terminalDivRect.top
                };
            }
        },
        beforeMount() {
            var l = getUrlParam('language');
            if (l != null) {
                this.language = l;
            }
            var id = getUrlParam('id');
            if (id != null) {
                this.tutorialId = id;
            }
        }
    })

</script>

<script>
    var _hmt = _hmt || [];
    (function () {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?d5c5e25b100f0eb51a4c35c8a86ea9b4";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
    })();
</script>

</html>